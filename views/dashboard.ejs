<%- include('header') %>

<script>
    document.getElementById('pageTitle').textContent = 'Dashboard';
    document.getElementById('pageSubtitle').textContent = 'Welcome back, <%= user.name %>';

    // Show notification on refresh
    document.addEventListener('DOMContentLoaded', () => {
        if (typeof showToast === 'function') {
            showToast('System online. All services operational.', 'success', 'VBase System');
        }
    });
</script>

<main class="dashboard-container">
    <div class="dashboard-header">
        <h1>Your Dashboard</h1>
    </div>

    <div class="dashboard-grid">
        <div class="dashboard-card">
            <h3>Current Plan</h3>
            <p class="card-value"><%= user.plan.charAt(0).toUpperCase() + user.plan.slice(1) %></p>
            <p style="color: var(--text-secondary); font-size: 0.9rem;">Limit: <%= user.limits[user.plan].toLocaleString() %>/month</p>
        </div>
        <div class="dashboard-card">
            <h3>Requests Used</h3>
            <p class="card-value"><%= user.requests %></p>
            <div class="progress-bar">
                <div class="progress" style="width: <%= (user.requests / user.limits[user.plan]) * 100 %>%"></div>
            </div>
        </div>
        <div class="dashboard-card">
            <h3>Your Databases</h3>
            <p class="card-value"><%= user.databases.length %></p>
            <a href="/databases" class="btn-link">Manage</a>
        </div>
        <div class="dashboard-card">
            <h3>API Key</h3>
            <p class="api-key"><%= user.apiKey %></p>
            <button class="btn-small" onclick="copyToClipboard('<%= user.apiKey %>')">Copy</button>
        </div>
    </div>

    <section class="quick-actions">
        <h2>Quick Actions</h2>
        <div class="action-buttons">
            <a href="/databases" class="btn-action">Create Database</a>
            <a href="/tools" class="btn-action">API Tools</a>
            <a href="/docs" class="btn-action">Docs</a>
            <a href="/profile" class="btn-action">Settings</a>
        </div>
    </section>

    <section class="api-guide">
        <h2>API Usage Guide</h2>
        <p style="color: var(--text-secondary); margin-bottom: 1rem;">Use your API key to access the VBase API</p>
        <div class="code-block">
<pre>// Insert Data
curl -X POST https://vbase.zone.id/api/db/DB_ID/insert \
  -H "X-API-Key: <%= user.apiKey %>" \
  -H "Content-Type: application/json" \
  -d '{"name": "John", "age": 30}'

// Get All Data
curl https://vbase.zone.id/api/db/DB_ID/select \
  -H "X-API-Key: <%= user.apiKey %>"

// Update Record
curl -X POST https://vbase.zone.id/api/db/DB_ID/update/RECORD_ID \
  -H "X-API-Key: <%= user.apiKey %>" \
  -d '{"name": "Jane"}'

// Delete Record
curl -X DELETE https://vbase.zone.id/api/db/DB_ID/delete/RECORD_ID \
  -H "X-API-Key: <%= user.apiKey %>"</pre>
        </div>
    </section>
</main>

<%- include('footer') %>
